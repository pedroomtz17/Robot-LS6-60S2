function qpp=din_dir(q1,q2,q3,q4,q1p,q2p,q3p,q4p,t1,t2,t3,t4)

M =[ (33631*sin(q2)^2)/160000 + (2*((13*cos(q4)*sin(q2))/40 + sin(q4)*((13*cos(q2))/40 + 11/40))^2)/25 + (2*(cos(q4)*((13*cos(q2))/40 + 11/40) - (13*sin(q2)*sin(q4))/40 + 3/5)^2)/25 + (21*((13*cos(q2))/40 + 4/25)^2)/25 + (23*((13*cos(q2))/40 + 141/200)^2)/20 + 1307/2500, (245739*cos(q2))/800000 + ((11*cos(q4))/500 + 6/125)*(cos(q4)*((13*cos(q2))/40 + 11/40) - (13*sin(q2)*sin(q4))/40 + 3/5) + (11*sin(q4)*((13*cos(q4)*sin(q2))/40 + sin(q4)*((13*cos(q2))/40 + 11/40)))/500 + 3572331/4000000,       0, (6*cos(q4)*((13*cos(q2))/40 + 11/40))/125 - (39*sin(q2)*sin(q4))/2500 + 147/2500;
                                               (245739*cos(q2))/800000 + ((11*cos(q4))/500 + 6/125)*(cos(q4)*((13*cos(q2))/40 + 11/40) - (13*sin(q2)*sin(q4))/40 + 3/5) + (11*sin(q4)*((13*cos(q4)*sin(q2))/40 + sin(q4)*((13*cos(q2))/40 + 11/40)))/500 + 3572331/4000000,                                                                                                                        (121*sin(q4)^2)/20000 + (2*((11*cos(q4))/40 + 3/5)^2)/25 + 62845111564234658531/70368744177664000000,       0,                                                     (33*cos(q4))/2500 + 147/2500;
                                                                                                                                                                                                                                                                         0,                                                                                                                                                                                                                           0, 123/100,                                                                                0;
                                                                                                                                                                                          (6*cos(q4)*((13*cos(q2))/40 + 11/40))/125 - (39*sin(q2)*sin(q4))/2500 + 147/2500,                                                                                                                                                                                                (33*cos(q4))/2500 + 147/2500,       0,                                                                         147/2500];

C = [                                                                                                                                                                                                          - q2p*(q4p*(((13*cos(q4)*sin(q2))/40 + sin(q4)*((13*cos(q2))/40 + 11/40))*((11*cos(q4))/500 + 6/125) - (11*cos(q4)*((13*cos(q4)*sin(q2))/40 + sin(q4)*((13*cos(q2))/40 + 11/40)))/500 + (11*sin(q4)*((13*sin(q2)*sin(q4))/40 - cos(q4)*((13*cos(q2))/40 + 11/40)))/500 + (11*sin(q4)*(cos(q4)*((13*cos(q2))/40 + 11/40) - (13*sin(q2)*sin(q4))/40 + 3/5))/500) + q2p*((245739*sin(q2))/800000 + ((13*cos(q2)*sin(q4))/40 + (13*cos(q4)*sin(q2))/40)*((11*cos(q4))/500 + 6/125) - (11*sin(q4)*((13*cos(q2)*cos(q4))/500 - (13*sin(q2)*sin(q4))/500))/40)) - q4p*(q4p*((39*cos(q4)*sin(q2))/2500 + (6*sin(q4)*((13*cos(q2))/40 + 11/40))/125) + q2p*((39*cos(q2)*sin(q4))/2500 + (39*cos(q4)*sin(q2))/2500)) - q1p*(q4p*(((13*cos(q4)*sin(q2))/40 + sin(q4)*((13*cos(q2))/40 + 11/40))*((13*sin(q2)*sin(q4))/250 - (4*cos(q4)*((13*cos(q2))/40 + 11/40))/25) + ((13*cos(q4)*sin(q2))/250 + (4*sin(q4)*((13*cos(q2))/40 + 11/40))/25)*(cos(q4)*((13*cos(q2))/40 + 11/40) - (13*sin(q2)*sin(q4))/40 + 3/5)) + q2p*(((13*cos(q2)*sin(q4))/250 + (13*cos(q4)*sin(q2))/250)*(cos(q4)*((13*cos(q2))/40 + 11/40) - (13*sin(q2)*sin(q4))/40 + 3/5) - ((13*cos(q4)*sin(q2))/40 + sin(q4)*((13*cos(q2))/40 + 11/40))*((13*cos(q2)*cos(q4))/250 - (13*sin(q2)*sin(q4))/250) - (33631*cos(q2)*sin(q2))/80000 + (273*sin(q2)*((13*cos(q2))/40 + 4/25))/500 + (299*sin(q2)*((13*cos(q2))/40 + 141/200))/400));
 q1p*((q4p*((39*cos(q2)*sin(q4))/2500 + (39*cos(q4)*sin(q2))/2500))/2 + (q1p*(((13*cos(q2)*sin(q4))/250 + (13*cos(q4)*sin(q2))/250)*(cos(q4)*((13*cos(q2))/40 + 11/40) - (13*sin(q2)*sin(q4))/40 + 3/5) - ((13*cos(q4)*sin(q2))/40 + sin(q4)*((13*cos(q2))/40 + 11/40))*((13*cos(q2)*cos(q4))/250 - (13*sin(q2)*sin(q4))/250) - (33631*cos(q2)*sin(q2))/80000 + (273*sin(q2)*((13*cos(q2))/40 + 4/25))/500 + (299*sin(q2)*((13*cos(q2))/40 + 141/200))/400))/2 + (q2p*((245739*sin(q2))/800000 + ((13*cos(q2)*sin(q4))/40 + (13*cos(q4)*sin(q2))/40)*((11*cos(q4))/500 + 6/125) - (11*sin(q4)*((13*cos(q2)*cos(q4))/500 - (13*sin(q2)*sin(q4))/500))/40))/2) - (33*q4p^2*sin(q4))/2500 - q1p*(q4p*(((13*cos(q4)*sin(q2))/40 + sin(q4)*((13*cos(q2))/40 + 11/40))*((11*cos(q4))/500 + 6/125) - (11*cos(q4)*((13*cos(q4)*sin(q2))/40 + sin(q4)*((13*cos(q2))/40 + 11/40)))/500 + (11*sin(q4)*((13*sin(q2)*sin(q4))/40 - cos(q4)*((13*cos(q2))/40 + 11/40)))/500 + (11*sin(q4)*(cos(q4)*((13*cos(q2))/40 + 11/40) - (13*sin(q2)*sin(q4))/40 + 3/5))/500) + q2p*((245739*sin(q2))/800000 + ((13*cos(q2)*sin(q4))/40 + (13*cos(q4)*sin(q2))/40)*((11*cos(q4))/500 + 6/125) - (11*sin(q4)*((13*cos(q2)*cos(q4))/500 - (13*sin(q2)*sin(q4))/500))/40)) + (q1p*q2p*((245739*sin(q2))/800000 + ((13*cos(q2)*sin(q4))/40 + (13*cos(q4)*sin(q2))/40)*((11*cos(q4))/500 + 6/125) - (11*sin(q4)*((13*cos(q2)*cos(q4))/500 - (13*sin(q2)*sin(q4))/500))/40))/2 + q2p*q4p*((121*cos(q4)*sin(q4))/10000 - (11*sin(q4)*((11*cos(q4))/40 + 3/5))/250) + (q1p*q4p*((39*cos(q2)*sin(q4))/2500 + (39*cos(q4)*sin(q2))/2500))/2;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        0;
                                                                             q4p*((q1p*((39*cos(q4)*sin(q2))/2500 + (6*sin(q4)*((13*cos(q2))/40 + 11/40))/125))/2 + (33*q2p*sin(q4))/5000) + q2p*((q1p*(((13*cos(q4)*sin(q2))/40 + sin(q4)*((13*cos(q2))/40 + 11/40))*((11*cos(q4))/500 + 6/125) - (11*cos(q4)*((13*cos(q4)*sin(q2))/40 + sin(q4)*((13*cos(q2))/40 + 11/40)))/500 + (11*sin(q4)*((13*sin(q2)*sin(q4))/40 - cos(q4)*((13*cos(q2))/40 + 11/40)))/500 + (11*sin(q4)*(cos(q4)*((13*cos(q2))/40 + 11/40) - (13*sin(q2)*sin(q4))/40 + 3/5))/500))/2 - (q2p*((121*cos(q4)*sin(q4))/10000 - (11*sin(q4)*((11*cos(q4))/40 + 3/5))/250))/2 + (33*q4p*sin(q4))/5000) + q1p*((q2p*(((13*cos(q4)*sin(q2))/40 + sin(q4)*((13*cos(q2))/40 + 11/40))*((11*cos(q4))/500 + 6/125) - (11*cos(q4)*((13*cos(q4)*sin(q2))/40 + sin(q4)*((13*cos(q2))/40 + 11/40)))/500 + (11*sin(q4)*((13*sin(q2)*sin(q4))/40 - cos(q4)*((13*cos(q2))/40 + 11/40)))/500 + (11*sin(q4)*(cos(q4)*((13*cos(q2))/40 + 11/40) - (13*sin(q2)*sin(q4))/40 + 3/5))/500))/2 + (q4p*((39*cos(q4)*sin(q2))/2500 + (6*sin(q4)*((13*cos(q2))/40 + 11/40))/125))/2 + (q1p*(((13*cos(q4)*sin(q2))/40 + sin(q4)*((13*cos(q2))/40 + 11/40))*((13*sin(q2)*sin(q4))/250 - (4*cos(q4)*((13*cos(q2))/40 + 11/40))/25) + ((13*cos(q4)*sin(q2))/250 + (4*sin(q4)*((13*cos(q2))/40 + 11/40))/25)*(cos(q4)*((13*cos(q2))/40 + 11/40) - (13*sin(q2)*sin(q4))/40 + 3/5)))/2) - q1p*(q4p*((39*cos(q4)*sin(q2))/2500 + (6*sin(q4)*((13*cos(q2))/40 + 11/40))/125) + q2p*((39*cos(q2)*sin(q4))/2500 + (39*cos(q4)*sin(q2))/2500)) - (33*q2p*q4p*sin(q4))/2500];

 

G =[     0;
         0;
   12.0663;
         0];
     
tau=[t1;t2;t3;t4];
%vector columna de fricciones (energía disipativa al presentarse velocidad)
f=[0.123*q1p;0.123*q2p;10*q3p;0.123*q4p];
% qpp=inv(M)*(tau-C-G);
qpp=inv(M)*(tau-f-C-G);


end