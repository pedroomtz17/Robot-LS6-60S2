function qpp=din_dir(q1,q2,q3,q4,q1p,q2p,q3p,q4p,t1,t2,t3,t4)

M =[(33631*sin(q2)^2)/160000 + (2*((13*cos(q4)*sin(q2))/40 + sin(q4)*((13*cos(q2))/40 + 11/40))^2)/25 + (2*((13*sin(q2)*sin(q4))/40 - cos(q4)*((13*cos(q2))/40 + 11/40))^2)/25 + (199*((13*cos(q2))/40 + 11/40)^2)/100 + 21/100, (28457*cos(q2))/160000 - (11*cos(q4)*((13*sin(q2)*sin(q4))/40 - cos(q4)*((13*cos(q2))/40 + 11/40)))/500 + (11*sin(q4)*((13*cos(q4)*sin(q2))/40 + sin(q4)*((13*cos(q2))/40 + 11/40)))/500 + 52879/160000,       0, 1/100;
                     (28457*cos(q2))/160000 - (11*cos(q4)*((13*sin(q2)*sin(q4))/40 - cos(q4)*((13*cos(q2))/40 + 11/40)))/500 + (11*sin(q4)*((13*cos(q4)*sin(q2))/40 + sin(q4)*((13*cos(q2))/40 + 11/40)))/500 + 52879/160000,                                                                                                                        (121*cos(q4)^2)/20000 + (121*sin(q4)^2)/20000 + 744205764674139/2251799813685248,       0, 1/100;
                                                                                                                                                                                                                           0,                                                                                                                                                                                                       0, 123/100,     0;
                                                                                                                                                                                                                       1/100,                                                                                                                                                                                                   1/100,       0, 1/100];



 
C =[                                                                                                                                                                                              ((11*sin(q4)*((13*cos(q2)*cos(q4))/40 - (13*sin(q2)*sin(q4))/40))/500 - (11*cos(q4)*((13*cos(q2)*sin(q4))/40 + (13*cos(q4)*sin(q2))/40))/500 - (28457*sin(q2))/160000)*q2p^2 + q1p*((33631*cos(q2)*sin(q2))/80000 + ((13*cos(q4)*sin(q2))/40 + sin(q4)*((13*cos(q2))/40 + 11/40))*((13*cos(q2)*cos(q4))/250 - (13*sin(q2)*sin(q4))/250) + ((13*sin(q2)*sin(q4))/40 - cos(q4)*((13*cos(q2))/40 + 11/40))*((13*cos(q2)*sin(q4))/250 + (13*cos(q4)*sin(q2))/250) - (2587*sin(q2)*((13*cos(q2))/40 + 11/40))/2000)*q2p;
 q1p*((q2p*((28457*sin(q2))/160000 + (11*cos(q4)*((13*cos(q2)*sin(q4))/40 + (13*cos(q4)*sin(q2))/40))/500 - (11*sin(q4)*((13*cos(q2)*cos(q4))/40 - (13*sin(q2)*sin(q4))/40))/500))/2 - (q1p*((33631*cos(q2)*sin(q2))/80000 + ((13*cos(q4)*sin(q2))/40 + sin(q4)*((13*cos(q2))/40 + 11/40))*((13*cos(q2)*cos(q4))/250 - (13*sin(q2)*sin(q4))/250) + ((13*sin(q2)*sin(q4))/40 - cos(q4)*((13*cos(q2))/40 + 11/40))*((13*cos(q2)*sin(q4))/250 + (13*cos(q4)*sin(q2))/250) - (2587*sin(q2)*((13*cos(q2))/40 + 11/40))/2000))/2) - (q1p*q2p*((28457*sin(q2))/160000 + (11*cos(q4)*((13*cos(q2)*sin(q4))/40 + (13*cos(q4)*sin(q2))/40))/500 - (11*sin(q4)*((13*cos(q2)*cos(q4))/40 - (13*sin(q2)*sin(q4))/40))/500))/2;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               0;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               0];
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
G =[     0;
         0;
   12.0663;
         0];
     
tau=[t1;t2;t3;t4];
f=[0.123*q1p;0.123*q2p;200*q3p;0.123*q4p];
% qpp=inv(M)*(tau-C-G);
qpp=inv(M)*(tau-f-C-G);


end